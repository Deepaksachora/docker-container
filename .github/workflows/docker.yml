name: Build and Run Docker Container
on:
  push:
    branches:
      - main

jobs:
  build:
    name: Build Docker Container
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v2
      
      - name: Build Docker image
        uses: docker/build-push-action@v2
        with:
          context: .
          push: false
          tags: my-docker-image:latest
      
  run:
    name: Run Docker Container
    runs-on: ubuntu-latest
    needs: build
    steps:
      - name: Checkout code
        uses: actions/checkout@v2
      
      - name: Start Docker Container
        uses: docker/compose-action@1.0.4
        with:
          compose-file: docker-compose.yml
          service: my-docker-service
          detached: true
